# =============================================================================
# CUAD 合同助手 - 测试环境配置
# 用途: 快速验证、调试、CI/CD
# 启动: python scripts/run_api.py --mode test
# =============================================================================

# 继承 base.yaml，以下为覆盖项

# -----------------------------------------------------------------------------
# 数据采样 - 仅加载 10% 数据
# -----------------------------------------------------------------------------
data:
  sampling:
    enabled: true
    ratio: 0.1              # 10% 数据采样
    seed: 42                # 固定种子保证可复现
    cache_enabled: true     # 启用缓存，避免重复采样

# -----------------------------------------------------------------------------
# 模型配置 - 减小批次加速测试
# -----------------------------------------------------------------------------
models:
  embedding:
    batch_size: 32          # 减小批次

# -----------------------------------------------------------------------------
# 检索配置 - 减少检索数量
# -----------------------------------------------------------------------------
retrieval:
  hybrid:
    top_k: 20               # 减少检索数量
  
  rerank:
    top_k: 10                # 减少重排数量

# -----------------------------------------------------------------------------
# 缓存配置 - 测试模式使用内存缓存
# -----------------------------------------------------------------------------
cache:
  semantic:
    enabled: true
    backend: "memory"       # 使用内存缓存，无需 Redis
    similarity_threshold: 0.95
    ttl_seconds: 3600       # 1小时过期
    max_entries: 1000

# -----------------------------------------------------------------------------
# 评估配置 - 关闭 WandB
# -----------------------------------------------------------------------------
evaluation:
  wandb:
    enabled: false          # 测试模式关闭 WandB

# -----------------------------------------------------------------------------
# 日志配置 - DEBUG 级别
# -----------------------------------------------------------------------------
logging:
  level: "DEBUG"
  file: "${PROJECT_ROOT}/logs/test.log"
